<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>NCC DarkCPU: src/peLoader-10c.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="large.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">NCC DarkCPU
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('pe_loader-10c_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">peLoader-10c.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module is responsible for loading and initilizing PE Images to be executed.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a65db503497d54be2bc402b81b6f1222a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#a65db503497d54be2bc402b81b6f1222a">PEIMAGE_SIGNATURE</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_SIGNATURE */</td></tr>
<tr class="separator:a65db503497d54be2bc402b81b6f1222a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93144628217dc57b97def79abf6242cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#a93144628217dc57b97def79abf6242cd">PEIMAGE_NAMELEN</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_NAMELEN */</td></tr>
<tr class="separator:a93144628217dc57b97def79abf6242cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a632846409ad88f676f694d9f37887006"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#a632846409ad88f676f694d9f37887006">PEIMAGE_INVALID_NEXT</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_INVALID_NEXT */</td></tr>
<tr class="separator:a632846409ad88f676f694d9f37887006"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee90958d0f4da0bf48b73315d28c10f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#aee90958d0f4da0bf48b73315d28c10f3">PEIMAGE_INVALID_IMPORT</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_INVALID_IMPORT */</td></tr>
<tr class="separator:aee90958d0f4da0bf48b73315d28c10f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2174be3a3e6a615d53f60adca95e39"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#aba2174be3a3e6a615d53f60adca95e39">PEIMAGE_INVALID_EXPORT</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_INVALID_EXPORT */</td></tr>
<tr class="separator:aba2174be3a3e6a615d53f60adca95e39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7367f3fc0b85740f1f8a2cd9159fc9d8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#a7367f3fc0b85740f1f8a2cd9159fc9d8">PEIMAGE_OFFSET_SIGNATURE</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_SIGNATURE */</td></tr>
<tr class="separator:a7367f3fc0b85740f1f8a2cd9159fc9d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6413ec79a4ff8d7adca96b50b1fd6e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#af6413ec79a4ff8d7adca96b50b1fd6e5">PEIMAGE_OFFSET_NEXT</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_NEXT */</td></tr>
<tr class="separator:af6413ec79a4ff8d7adca96b50b1fd6e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe0892be923978ba1a0dfe39b8b7aa63"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#abe0892be923978ba1a0dfe39b8b7aa63">PEIMAGE_OFFSET_NAME</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_NAME */</td></tr>
<tr class="separator:abe0892be923978ba1a0dfe39b8b7aa63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b5120bc94a978bc9fa49aab4e389079"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#a0b5120bc94a978bc9fa49aab4e389079">PEIMAGE_OFFSET_RVA_ENTRY_POINT</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_RVA_ENTRY_POINT */</td></tr>
<tr class="separator:a0b5120bc94a978bc9fa49aab4e389079"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f03a8f440bc2555a680a28671deee1f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#a1f03a8f440bc2555a680a28671deee1f">PEIMAGE_OFFSET_RVA_IMPORT_TABLE</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_RVA_IMPORT_TABLE */</td></tr>
<tr class="separator:a1f03a8f440bc2555a680a28671deee1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab26be4f469b16b369d85fa2240a62e0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#aab26be4f469b16b369d85fa2240a62e0">PEIMAGE_OFFSET_RVA_EXPORT_TABLE</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_RVA_EXPORT_TABLE */</td></tr>
<tr class="separator:aab26be4f469b16b369d85fa2240a62e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb08aa41ea80b6c137914607d1ffe43c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acb08aa41ea80b6c137914607d1ffe43c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PEIMAGE_OFFSET_RVA_RELOCATION_TABLE</b>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_RVA_RELOCATION_TABLE */</td></tr>
<tr class="separator:acb08aa41ea80b6c137914607d1ffe43c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cd0850358cccc72cbc21e47d864d55c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#a1cd0850358cccc72cbc21e47d864d55c">PEIMAGE_OFFSET_IMAGE_SIZE</a>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_IMAGE_SIZE */</td></tr>
<tr class="separator:a1cd0850358cccc72cbc21e47d864d55c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e8b7d9187aa213203fa73b7b9469aa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab8e8b7d9187aa213203fa73b7b9469aa"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PEIMAGE_OFFSET_IMAGE_MD5SPECHASH</b>()&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_IMAGE_MD5SPECHASH */</td></tr>
<tr class="separator:ab8e8b7d9187aa213203fa73b7b9469aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afd247caccd6710d33319a49108c8e785"><td class="memItemLeft" align="right" valign="top">Returns&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#afd247caccd6710d33319a49108c8e785">peLoader_createImage</a> (pImage)</td></tr>
<tr class="memdesc:afd247caccd6710d33319a49108c8e785"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes and executes an executable image in memory.  <a href="#afd247caccd6710d33319a49108c8e785"></a><br/></td></tr>
<tr class="separator:afd247caccd6710d33319a49108c8e785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f8592a1417c2765f22c73be7d6788fd"><td class="memItemLeft" align="right" valign="top">Returns&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#a9f8592a1417c2765f22c73be7d6788fd">peLoader_findExport</a> (pBaseAddress, wOrdinal)</td></tr>
<tr class="memdesc:a9f8592a1417c2765f22c73be7d6788fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locates export from an executable image given the ordinal number and the base address of the image in memory.  <a href="#a9f8592a1417c2765f22c73be7d6788fd"></a><br/></td></tr>
<tr class="separator:a9f8592a1417c2765f22c73be7d6788fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5cd359c6df296e131be5c8f1fde2c26"><td class="memItemLeft" align="right" valign="top">Returns&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#ab5cd359c6df296e131be5c8f1fde2c26">peLoader_findImage</a> (sName)</td></tr>
<tr class="memdesc:ab5cd359c6df296e131be5c8f1fde2c26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locates an initialized executable image in memory.  <a href="#ab5cd359c6df296e131be5c8f1fde2c26"></a><br/></td></tr>
<tr class="separator:ab5cd359c6df296e131be5c8f1fde2c26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b18ea42e132e9f346f38383a0a408ca"><td class="memItemLeft" align="right" valign="top">Returns&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#a2b18ea42e132e9f346f38383a0a408ca">peLoader_findLastImage</a> (void)</td></tr>
<tr class="memdesc:a2b18ea42e132e9f346f38383a0a408ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the base address of last executable image in the linked list of initialized executable images.  <a href="#a2b18ea42e132e9f346f38383a0a408ca"></a><br/></td></tr>
<tr class="separator:a2b18ea42e132e9f346f38383a0a408ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a29c3a3cd89dabb122ce972d50a84e7c8"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pe_loader-10c_8c.html#a29c3a3cd89dabb122ce972d50a84e7c8">peLoader_root</a></td></tr>
<tr class="memdesc:a29c3a3cd89dabb122ce972d50a84e7c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Points to first entry in the linked list of excecutable images.  <a href="#a29c3a3cd89dabb122ce972d50a84e7c8"></a><br/></td></tr>
<tr class="separator:a29c3a3cd89dabb122ce972d50a84e7c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module is responsible for loading and initilizing PE Images to be executed. </p>
<p><a class="anchor" id="PeLoader"></a></p>
<p>This module contains various functions that can be used to load executable images, drivers and librarys into memory and begin executing them. </p>
<dl class="section author"><dt>Author</dt><dd>Jeremy (0x10cforums.com) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Dec, 14, 2012 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="aba2174be3a3e6a615d53f60adca95e39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_INVALID_EXPORT</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_INVALID_EXPORT */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Defines the value given to an invalid export entry, usually meaning that there are no more entries in the export table. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a> </p>

</div>
</div>
<a class="anchor" id="aee90958d0f4da0bf48b73315d28c10f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_INVALID_IMPORT</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_INVALID_IMPORT */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Defines the value given to an invalid import entry, usually meaning that there are no more entries in the import table. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a> </p>

</div>
</div>
<a class="anchor" id="a632846409ad88f676f694d9f37887006"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_INVALID_NEXT</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_INVALID_NEXT */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Defines the value given to an invalid next entry, usually meaning that there are no more entries in the chain. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a> </p>

</div>
</div>
<a class="anchor" id="a93144628217dc57b97def79abf6242cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_NAMELEN</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_NAMELEN */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This defines the number of words allocated for the module's name in the Executable Image File's Name member, refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a>. </p>

</div>
</div>
<a class="anchor" id="a1cd0850358cccc72cbc21e47d864d55c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_OFFSET_IMAGE_SIZE</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_IMAGE_SIZE */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Offset to the image's PEIMAGE structure pointing to the RVA_IMAGE_SIZE member. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a></p>
<p>Offset to the image's PEIMAGE structure pointing to the MD5SpecHash member. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a> </p>

</div>
</div>
<a class="anchor" id="abe0892be923978ba1a0dfe39b8b7aa63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_OFFSET_NAME</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_NAME */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Offset to the image's PEIMAGE structure pointing to the NAME member. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a> </p>

</div>
</div>
<a class="anchor" id="af6413ec79a4ff8d7adca96b50b1fd6e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_OFFSET_NEXT</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_NEXT */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Offset to the image's PEIMAGE structure pointing to the NEXT member. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a> </p>

</div>
</div>
<a class="anchor" id="a0b5120bc94a978bc9fa49aab4e389079"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_OFFSET_RVA_ENTRY_POINT</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_RVA_ENTRY_POINT */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Offset to the image's PEIMAGE structure pointing to the RVA_ENTRY_POINT member. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a> </p>

</div>
</div>
<a class="anchor" id="aab26be4f469b16b369d85fa2240a62e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_OFFSET_RVA_EXPORT_TABLE</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_RVA_EXPORT_TABLE */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Offset to the image's PEIMAGE structure pointing to the PEIMAGE_OFFSET_RVA_EXPORT_TABLE member. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a> </p>

</div>
</div>
<a class="anchor" id="a1f03a8f440bc2555a680a28671deee1f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_OFFSET_RVA_IMPORT_TABLE</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_RVA_IMPORT_TABLE */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Offset to the image's PEIMAGE structure pointing to the RVA_IMPORT_TABLE member. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a> </p>

</div>
</div>
<a class="anchor" id="a7367f3fc0b85740f1f8a2cd9159fc9d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_OFFSET_SIGNATURE</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_OFFSET_SIGNATURE */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Offset to the image's PEIMAGE structure pointing to the signature member. Refer to <a class="el" href="_pe_image_format.html">Executable Image Format</a> </p>

</div>
</div>
<a class="anchor" id="a65db503497d54be2bc402b81b6f1222a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEIMAGE_SIGNATURE</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* peLoader.10c, PEIMAGE_SIGNATURE */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>PEIMAGE_SIGNATURE This defines the first word in every executable image that validates it is an executable image. The <a class="el" href="pe_loader-10c_8c.html#PeLoader">PeLoader</a> will fail to load exeuctable images which do not poses this signature as their first byte. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="afd247caccd6710d33319a49108c8e785"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Returns peLoader_createImage </td>
          <td>(</td>
          <td class="paramtype">pImage&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes and executes an executable image in memory. </p>
<dl class="section note"><dt>Note</dt><dd>Uses cdecl calling convention. <a class="el" href="calling_conventions.html#cdecl">cdecl</a></dd></dl>
<p>This routine will take the address of the loaded executable image in memory provided via the arguments, initializes the image's Import Address Table, adds it to the task chain, corrects its export table (adds its base address to the export rvas described in the export table) and creates a thread at its entrypoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pImage</td><td>A pointer to the raw executable image in memory to Initializes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a 0 on error, and anything else otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="a9f8592a1417c2765f22c73be7d6788fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Returns peLoader_findExport </td>
          <td>(</td>
          <td class="paramtype">pBaseAddress&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">wOrdinal&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locates export from an executable image given the ordinal number and the base address of the image in memory. </p>
<dl class="section note"><dt>Note</dt><dd>Uses cdecl calling convention. <a class="el" href="calling_conventions.html#cdecl">cdecl</a></dd></dl>
<p>Determines the address of an executable's export given the export ordinal. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pBaseAddress</td><td>Base address of the executable image to search for the ordinal in. </td></tr>
    <tr><td class="paramname">wOrdinal</td><td>Ordinal corresponding to the export to find. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns address of the data exported at that ordinal. </dd></dl>

</div>
</div>
<a class="anchor" id="ab5cd359c6df296e131be5c8f1fde2c26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Returns peLoader_findImage </td>
          <td>(</td>
          <td class="paramtype">sName&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locates an initialized executable image in memory. </p>
<dl class="section note"><dt>Note</dt><dd>Uses cdecl calling convention. <a class="el" href="calling_conventions.html#cdecl">cdecl</a></dd></dl>
<p>Determines the address of an executable in memory and returns the base address of that image. This is done by walking through the linked list and comapring each entries name with the one we are looknig for. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sName</td><td>Name of the module to locate the base address of. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns base address of executable image in memory, or zero if the entry was not found. </dd></dl>

</div>
</div>
<a class="anchor" id="a2b18ea42e132e9f346f38383a0a408ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Returns peLoader_findLastImage </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the base address of last executable image in the linked list of initialized executable images. </p>
<dl class="section note"><dt>Note</dt><dd>Uses cdecl calling convention. <a class="el" href="calling_conventions.html#cdecl">cdecl</a></dd></dl>
<p>Locates the last executable image in the linked list of initialized executable images (whose root node is defined in peLoader_root) and returns the base address of that image. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns address of the last executable image in the list of initialized executable images. </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Meant for internal use only. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a29c3a3cd89dabb122ce972d50a84e7c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">peLoader_root</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Points to first entry in the linked list of excecutable images. </p>
<p>Stores the first entry in the linked list of executable images loaded into memory. This is always the kernel. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="pe_loader-10c_8c.html">peLoader-10c.c</a></li>
    <li class="footer">Generated on Sat Dec 22 2012 23:26:30 for NCC DarkCPU by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
