<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>NCC DarkCPU: Standard Interface Specifications</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="large.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">NCC DarkCPU
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__standard_drivers.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Standard Interface Specifications </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>This document needs improvement.</dd></dl>
<h1>Purpose</h1>
<p>The document provides an overview of interfaces implemented by the DarkCPU team, or other well accepted interfaces that are widely-used about the DarkCPU Development Community.</p>
<h2>Storage Device</h2>
<p><a class="anchor" id="DDSSI"></a></p>
<h3>DarkDev Std Storage Interface (DDSSI)</h3>
<h4>Description of standard</h4>
<p>This is the standard storage device interface. If possible, the device should also implement the DarkDev Std Cachable Storage Extention Interface (<a class="el" href="md__standard_drivers.html#DDSCS">DDSCS</a>) as well. Below is the <a class="el" href="md__m_d5_spec_hash.html#SpecTable">SpecTable</a> and the MD5SpecTable</p>
<table class="doxtable">
<tr>
<th>StdMediaStorageCachable </th><th>81522d235e215fd3fb490fa71a4f326f</th></tr>
<tr>
<td>sFunction </td><td>MediaStorage </td></tr>
<tr>
<td>sSpecificationName </td><td>DDSSI </td></tr>
<tr>
<td>sSpecificationPublisher </td><td>DarkDev </td></tr>
<tr>
<td>bVersionMajor </td><td>1 </td></tr>
<tr>
<td>bVersionMinor </td><td>0 </td></tr>
</table>
<p>The DDSSI states the following must be true for the export table of the driver implementing the specification: </p>
<pre class="fragment">WORD getFlags() at ordinal 0
    cdecl calling convention
    returns: Storage Device Flags

    Flags define accessiblity of filesystem
        bit 0 if set, read only device

WORD getSectorSize() at ordinal 1
    cdecl calling convention
    returns: Size in words of the volume's sectors.

WORD getVolumeSize() at ordinal 2
    cdecl calling convention
    returns: Size of volume, in units of volume sectors

void read(WORD wSectorPos, WORD wOffset, WORD* pDest, WORD wSize) at ordinal 3
    cdecl calling convention
    wSectorPos  Position in units of sector size
    wOffset     Offset in words from the origin of wSectorPos
    pDest       Pointer to destination of read data
    wSize       size of buffer in words

void write(WORD wChunkPos, WORD wOffset, WORD* pSrc, WORD wSize) at ordinal 4
    cdecl calling convention
    wSectorPos  Position in units of sector size
    wOffset     Offset in words from the origin of wSectorPos
    pSrc        Pointer to data to be written to disk
    wSize       size of buffer in words
</pre><h4>Storage Extentions</h4>
<p><a class="anchor" id="DDSCS"></a></p>
<h5>DarkDev Std Cachable Storage Extention Interface (DDSCS)</h5>
<p>This is the standard extention interface for cachable storage devices. Implementing this will allow more optimal use of your storage device. Below is the <a class="el" href="md__m_d5_spec_hash.html#SpecTable">SpecTable</a> and the MD5SpecTable</p>
<table class="doxtable">
<tr>
<th>StdMediaStorageCachable </th><th>06e4c3e7ecf6ecaa4d7351677f529b81</th></tr>
<tr>
<td>sFunction </td><td>MediaStorage </td></tr>
<tr>
<td>sSpecificationName </td><td>StdCache </td></tr>
<tr>
<td>sSpecificationPublisher </td><td>DarkDev </td></tr>
<tr>
<td>bVersionMajor </td><td>1 </td></tr>
<tr>
<td>bVersionMinor </td><td>0 </td></tr>
</table>
<p>The DDSCS states the following must be true for the export table of the driver implementing the specification:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> beginCache(WORD wSectorPos, WORD wCacheSize) at ordinal 0</div>
<div class="line">    wSectorPos  Sector to begin cache</div>
<div class="line">    wCacheSize  Size in words of the cache</div>
<div class="line">    Attempts to create a cache of the given memory. Does not guarantee cache was allocated.</div>
<div class="line"></div>
<div class="line">void endCache(WORD wSectorPos)  at ordinal 1</div>
<div class="line">    wSectorPos  Sector where previous allocated cache was created</div>
<div class="line">    Attempts to destroy an interal cache at the specified address, or does nothing <span class="keywordflow">if</span> no cache exists <span class="keywordflow">for</span> the specified sector.</div>
</div><!-- fragment --><h2>DarkDev Std Filesystem Interface</h2>
<p>This is the filesystem interface that must be adapted for all filesystem interfaces that will be used with the DarkCPU Virtual File-System. Below is the <a class="el" href="md__m_d5_spec_hash.html#SpecTable">SpecTable</a> and the MD5SpecTable</p>
<table class="doxtable">
<tr>
<th>StdFsInterfaceDriver </th><th>f46e7e79daa98f6c3ead897517e6bdea</th></tr>
<tr>
<td>sFunction </td><td>VFSFSI </td></tr>
<tr>
<td>sSpecificationName </td><td>StdFSI </td></tr>
<tr>
<td>sSpecificationPublisher </td><td>DarkDev </td></tr>
<tr>
<td>bVersionMajor </td><td>1 </td></tr>
<tr>
<td>bVersionMinor </td><td>0 </td></tr>
</table>
<p>The VFSFSI states the following must be true for the export table of the driver implementing the specification:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> fsStart(FILE* pRoot) at ordinal 0</div>
<div class="line">    cdecl calling convention</div>
<div class="line">    pRoot  Pointer to file structure describing root folder of storage media <span class="keyword">using</span> interface</div>
<div class="line">           Called per instance of mountpoint when media <span class="keyword">using</span> filesystem <span class="keyword">interface </span>driver is mounted.</div>
<div class="line"></div>
<div class="line">void fsEnd(FILE* pRoot) at ordinal 1</div>
<div class="line">    cdecl calling convention</div>
<div class="line">    pRoot    Pointer to file structure describing root folder of storage media <span class="keyword">using</span> interface</div>
<div class="line">             Called per instance of mountpoint when media <span class="keyword">using</span> filesystem interface driver is unmounted.</div>
<div class="line"></div>
<div class="line">void fsGetRoot(FILE* pRoot) at ordinal 2</div>
<div class="line">    pRoot is a pointer to a file descriptor structure where details of root directory are placed in.</div>
<div class="line"></div>
<div class="line">void fopen(FILE* pParent, WORD* sFileNameMultibyte, FILE* pFile) at ordinal 3</div>
<div class="line">    cdecl calling convention</div>
<div class="line">    pParent  Pointer to parent file descriptor of file to be open</div>
<div class="line">    pFile    Pointer to where the output file descriptor is stored.</div>
<div class="line"></div>
<div class="line">void fClose(FILE* pFile) at ordinal 4</div>
<div class="line">    cdecl calling convention</div>
<div class="line">    pFile    Pointer to file descriptor of file to be closed</div>
<div class="line">    Closes the specified file. If no cleanup is required after opening a file, <span class="keyword">this</span> can be ignored</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> fRead(FILE* pFile, WORD* pBuffer, WORD wBufferSize) at ordinal 5</div>
<div class="line">    cdecl calling convention</div>
<div class="line">    pFile        Pointer to file descriptor of file to be read from.</div>
<div class="line">    pBuffer      Pointer to destination buffer where data is read into.</div>
<div class="line">    wBufferSize  The number of bytes to be read into the buffer.</div>
<div class="line">    returns:     Number of bytes read into buffer.</div>
<div class="line">                 Reads contents of pFile into pBuffer and advances the cursor. If reached the end of file, the eof bit is <span class="keyword">set</span>.</div>
<div class="line"></div>
<div class="line">unsigned <span class="keywordtype">long</span> fWrite(FILE* pFile, WORD* pBuffer, WORD wBufferSize) at ordinal 6</div>
<div class="line">    cdecl calling convention</div>
<div class="line">    pFile        Pointer to file descriptor of file to be written to.</div>
<div class="line">    pBuffer      Pointer to source buffer where data is read from.</div>
<div class="line">    wBufferSize  Size of destination buffer.</div>
<div class="line">    returns:     Number of bytes written to buffer.</div>
<div class="line">                 Write contents of pBuffer into pFile and advances the cursor.</div>
<div class="line"></div>
<div class="line">bool fEnum(FILE* pRootFile, FILE* pFile, WORD* sName) at ordinal 7</div>
<div class="line">    pRootFile Is a pointer to the file<span class="stringliteral">&#39;s which children are being enumerated.</span></div>
<div class="line"><span class="stringliteral">    pFile is a pointer to the file where the result of an adjacent file in the parent file is stored, and a pointer to the current file (or zero for the first file).</span></div>
<div class="line"><span class="stringliteral">    sName is a pointer to a data location where the name of the located adjacent file is stored. This parameter can be zero if there is no desire to get the file name. This buffer size must be VFS_NAMELEN words in length/</span></div>
<div class="line"><span class="stringliteral">    returns true if the current file passed is the last file.</span></div>
</div><!-- fragment --> <dl class="section attention"><dt>Attention</dt><dd>fOpen must be written such that the pParent argument can be both a descriptor for the parent directory the file is being loaded from and also the destination for the loaded file descriptor. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 14 2013 12:51:51 for NCC DarkCPU by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
